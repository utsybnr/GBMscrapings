# 概要
ガンダムブレイカーモバイル攻略まとめwiki[https://wiki.dengekionline.com/gbm/] からデータをスクレイピングするために作成したものです。Power Automate Desktop（以下、PAD）で構築しています。
全件取得と増分取得の2パターンが可能です。  
全件取得...wiki内のデータをすべて取得します。   
増分取得...直近の更新で追加されたデータのみ取得します。  

※公式wiki閉鎖済のため、実際の利用は不可能になりました。スクレイピング元を見たい場合はWayback Machine等を利用してください。

# フォルダ構成
- ソース ... PADで構築したフローのコード、およびスクリーンショットの格納先。1ファイルが1サブフローに相当し、すべてを合わせることで1フローです。
- マスタ ... 「URL関連.xlsx」を格納。基本的に操作不要です。
- 出力先 ... フロー実行時の書き込み先となるファイル。「●●_sample.xlsx」は書き込み後のサンプル。（取得データ全件）

# 利用方法
## 1. フォルダ配置
「マスタ」「出力先」の2フォルダを、任意のフォルダに配置します。（2つは同じフォルダ・階層に格納してください）

## 2. ソースの取り込み
「ソース」内の各ファイルにつき、ファイル名と同じサブフローを作成し、ファイルの内容をペーストしてください。

## 3. ソースの修正
- 「Main」の2行目、WorkspaceFolderの設定値（hogehogeの部分）を、「1. フォルダ配置」の格納先のパスに変更してください。
- 「Main」の11および22行目、サブフローの選択で、目的に応じフローを変更してください。
    - 全件取得 → 11行目：GetUnitLoop、22行目：GetStatusLoop
    - 増分取得 → 11行目：GetUnitLoop_LastModify、22行目：GetStatusLoop_LastModify
- (増分取得の場合のみ)「Main」の3行目、Targetの設定値を、wikiの最終更新時間に合わせ修正します。

## 4.フローの実行
フローを実行してください。
